# 出張精算システム 機能仕様書

## 1. システム概要

### 1.1 目的
本システムは、社内の出張精算業務を効率化・デジタル化することを目的とした Web アプリケーションです。従業員の出張費用申請から経理部門の承認・支払い処理まで、一連の業務フローをサポートします。

### 1.2 対象ユーザー
- **社員（申請者）**: 出張費用の精算申請を行う全従業員
- **経理部門**: 申請の審査・承認・支払い処理を行う経理担当者

### 1.3 システムの特徴
- 直感的で使いやすいユーザーインターフェース
- モバイルデバイス対応のレスポンシブデザイン
- リアルタイムでの申請状況確認
- セキュアな認証・認可機能
- 効率的な承認ワークフロー

## 2. 機能一覧

### 2.1 共通機能

#### 2.1.1 ログイン・ログアウト
- メールアドレスとパスワードによる認証
- セッション管理（JWT トークン使用）
- 自動ログアウト機能（一定時間操作なしの場合）

#### 2.1.2 ダッシュボード
- ログイン後のメイン画面
- ユーザーロールに応じた情報表示
- 最新の通知・アラート表示

#### 2.1.3 プロフィール管理
- ユーザー情報の確認・編集
- パスワード変更機能
- 部署情報の表示

### 2.2 社員向け機能

#### 2.2.1 精算申請作成
**機能概要**: 新規の出張精算申請を作成する

**入力項目**:
- 申請タイトル（例：「東京出張 - 顧客訪問」）
- 出張目的（詳細説明）
- 出張期間（開始日・終了日）
- 精算項目の追加
  - カテゴリー選択（交通費、宿泊費、食費、その他）
  - 項目説明
  - 金額
  - 費用発生日
  - 領収書アップロード（画像/PDF）

**機能詳細**:
- 下書き保存機能
- 精算項目の一括入力
- 合計金額の自動計算
- 入力内容の検証

#### 2.2.2 申請一覧・検索
**機能概要**: 自身の申請履歴を確認・検索する

**表示項目**:
- 申請番号
- タイトル
- 申請日
- 合計金額
- ステータス（下書き/申請中/承認済/却下/支払済）

**検索・フィルター機能**:
- ステータスによる絞り込み
- 期間指定検索
- キーワード検索

#### 2.2.3 申請詳細確認
**機能概要**: 申請の詳細情報を確認する

**表示内容**:
- 申請基本情報
- 精算項目一覧
- 領収書画像
- 承認履歴・コメント
- 現在のステータス

#### 2.2.4 申請編集・再提出
**機能概要**: 下書きまたは却下された申請を編集し、再提出する

**編集可能条件**:
- ステータスが「下書き」の場合
- ステータスが「却下」の場合

**機能詳細**:
- 全項目の編集が可能
- 却下理由を確認した上での修正
- 再提出時の追加コメント入力

### 2.3 経理部門向け機能

#### 2.3.1 承認待ち一覧
**機能概要**: 承認待ちの申請を一覧表示し、優先順位付けする

**表示項目**:
- 申請者情報（氏名、部署）
- 申請概要
- 提出日時
- 金額
- 緊急度フラグ

**ソート機能**:
- 提出日時順
- 金額順
- 部署別

#### 2.3.2 申請審査・承認
**機能概要**: 申請内容を詳細に確認し、承認・却下を判断する

**審査機能**:
- 申請内容の詳細確認
- 領収書の拡大表示
- 過去の申請履歴参照
- 承認/却下の選択
- コメント入力（却下時は必須）

#### 2.3.3 全申請管理
**機能概要**: システム内の全申請を管理する

**管理機能**:
- 全申請の検索・フィルター
- ステータス一括更新
- CSV エクスポート
- 申請者別の集計表示

#### 2.3.4 支払い処理
**機能概要**: 承認済み申請の支払い処理を管理する

**処理機能**:
- 支払い対象の一覧表示
- 支払い方法の選択（銀行振込等）
- 支払い完了の記録
- 支払い証明書の添付

#### 2.3.5 ユーザー管理
**機能概要**: システムユーザーの管理を行う

**管理項目**:
- 新規ユーザー登録
- ユーザー情報編集
- ロール変更（社員/経理）
- アカウント無効化

#### 2.3.6 レポート・分析
**機能概要**: 出張費用に関する各種レポートを生成する

**レポート種類**:
- 月次・四半期・年次サマリー
- 部署別費用分析
- カテゴリー別費用内訳
- 申請者別統計
- 承認率・却下率分析

**出力形式**:
- 画面表示（グラフ・表）
- PDF ダウンロード
- CSV エクスポート

## 3. 画面遷移

### 3.1 社員向け画面フロー
```
ログイン画面
    ↓
ダッシュボード
    ├→ 新規申請作成 → 申請確認 → 提出完了
    ├→ 申請一覧 → 申請詳細
    │              ├→ 編集（下書きの場合）
    │              └→ 再提出（却下の場合）
    └→ プロフィール設定
```

### 3.2 経理部門向け画面フロー
```
ログイン画面
    ↓
ダッシュボード
    ├→ 承認待ち一覧 → 申請審査 → 承認/却下
    ├→ 全申請管理 → 詳細確認/CSV出力
    ├→ 支払い処理 → 支払い完了登録
    ├→ ユーザー管理 → 新規登録/編集
    └→ レポート → 各種分析レポート
```

## 4. 業務フロー

### 4.1 標準的な申請フロー
1. **申請作成**: 社員が出張精算申請を作成
2. **申請提出**: 内容確認後、申請を提出
3. **審査**: 経理部門が申請内容を審査
4. **承認/却下**: 
   - 承認の場合 → 支払い処理へ
   - 却下の場合 → 申請者へ差し戻し
5. **支払い処理**: 経理部門が支払いを実行
6. **完了**: ステータスが「支払済」に更新

### 4.2 例外フロー
- **差し戻し対応**: 却下された申請を修正し再提出
- **申請取り下げ**: 提出後の申請を取り下げ（条件付き）
- **緊急承認**: 緊急フラグ付き申請の優先処理

## 5. データ保持期間とアーカイブ

### 5.1 データ保持
- アクティブデータ: 3年間
- アーカイブデータ: 7年間（法定保存期間）

### 5.2 アーカイブ対象
- 支払い完了から 3 年経過した申請
- 関連する領収書画像
- 承認履歴

## 6. 通知機能

### 6.1 社員向け通知
- 申請が承認された時
- 申請が却下された時
- 支払いが完了した時

### 6.2 経理部門向け通知
- 新規申請が提出された時
- 緊急フラグ付き申請がある時
- 月次締め処理のリマインダー

## 7. セキュリティ要件

### 7.1 アクセス制御
- ロールベースのアクセス制御（RBAC）
- 機能単位での権限設定
- 不正アクセスの検知・ブロック

### 7.2 データ保護
- 通信の暗号化（HTTPS）
- パスワードのハッシュ化
- 定期的なセキュリティ監査

### 7.3 監査ログ
- 全ての重要操作をログ記録
- ログの改ざん防止
- 定期的なログレビュー

## 8. パフォーマンス要件

### 8.1 レスポンス時間
- 画面表示: 3 秒以内
- 検索処理: 5 秒以内
- ファイルアップロード: 10 秒以内（10MB まで）

### 8.2 同時接続数
- 想定同時接続数: 100 ユーザー
- ピーク時対応: 200 ユーザー

## 9. 利用環境

### 9.1 推奨ブラウザ
- Google Chrome（最新版）
- Mozilla Firefox（最新版）
- Microsoft Edge（最新版）
- Safari（最新版）

### 9.2 対応デバイス
- デスクトップ PC
- タブレット（iPad、Android タブレット）
- スマートフォン（iPhone、Android）

## 10. 今後の拡張予定機能

### 10.1 フェーズ 2
- 領収書の OCR 自動読み取り
- 外部会計システムとの連携
- モバイルアプリの開発

### 10.2 フェーズ 3
- AI による異常検知
- 予算管理機能
- 多言語対応（英語、中国語）